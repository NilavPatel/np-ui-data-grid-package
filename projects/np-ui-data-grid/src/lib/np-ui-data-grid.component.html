<div class="np-grid" [style.height.px]="height" [style.width.px]="width" [id]="tableId">
    <div *ngIf="title.length > 0" class="np-grid-title">{{title}}</div>
    <div *ngIf="_showLoader" class="np-loader"></div>
    <div class="toolbar" *ngIf="showColumnChooser || enableStateStoring">
        <div class="toolbar-item" *ngIf="showColumnChooser">
            <button type="button" title="Column Chooser" class="column-chooser" *ngIf="showColumnChooser" (click)="_toggleColumnChooser()"><i class="demo-icon icon-columns"></i></button>
            <div class="column-chooser-content" *ngIf="showColumnChooser" [ngClass]="{'column-chooser-content-open':_isOpenColumnChooser}">
                <div><a class="close" (click)="_isOpenColumnChooser = false"><i class="demo-icon icon-cancel"></i></a>
                </div>
                <div *ngFor="let column of _columns; let j = index">
                    <label><input type="checkbox" [checked]="column.visible"
                            (change)="_onColumnChoosing(column)">{{column.getCaption()}}</label>
                </div>
            </div>
        </div>
        <div class="toolbar-item np-state-store" *ngIf="enableStateStoring">
            <select [(ngModel)]="_currentStateName" (change)="_loadState()">
                <option value="">Default</option>
                <option *ngFor="let state of _stateList" [ngValue]="state.name">{{state.name}}</option>
            </select>
            <button type="button" title="Save state" (click)="_saveState()" *ngIf="_currentStateName.length > 0"><i
                    class="demo-icon icon-save"></i></button>
            <button type="button" title="Delete state" (click)="_deleteState()" *ngIf="_currentStateName.length > 0"><i
                    class="demo-icon icon-trash"></i></button>
            <button type="button" title="Add state" (click)="_addState()"><i class="demo-icon icon-plus"></i></button>
        </div>
    </div>
    <div [style.height.px]="height - 82" style="overflow:auto" [ngClass]="{'locked': _showLoader}">
        <table class="np-grid-table">
            <thead>
                <tr class="np-grid-header-row">
                    <th *ngIf="_enableMasterChild" width="30px;" [ngClass]="{'np-sticky-header' : isStickyHeader}" class="txt-center"></th>
                    <th *ngIf="singleSelectEnable || multiSelectEnable" width="30px;" [ngClass]="{'np-sticky-header' : isStickyHeader}" class="txt-center">
                        <input class="row-selection-input" type="checkbox" *ngIf="multiSelectEnable" (change)="_onSelectAll($event)" [(ngModel)]="_isAllSelected" name="chkAllSelected">
                    </th>
                    <th *ngFor="let column of _columns; let j = index" [ngClass]="{'np-sticky-header' : isStickyHeader,'hidden': column.visible == false}" [style.width.px]="column.width">
                        <span [innerHTML]="column.getCaption()" (click)="_onSort(column)" [ngClass]="{'cursor-pointer': column.sortEnabled}" class="np-grid-header"></span>
                        <a [ngClass]="{'icon-sort-up': column.sortDirection === 0, 'icon-sort-down': column.sortDirection === 1}" class="demo-icon" (click)="_onSort(column)">
                        </a>
                        <a *ngIf="multiColumnSortEnable && column.sortDirection != null" (click)="_removeSortingFromColumn(column)" title="Remove sorting"><i
                                class="demo-icon icon-cancel"></i></a>
                    </th>
                </tr>
                <tr class="np-grid-header-row-filter">
                    <th *ngIf="_enableMasterChild" width="30px;" [ngClass]="{'np-sticky-header-filter' : isStickyHeader}" class="txt-center"></th>
                    <th *ngIf="singleSelectEnable || multiSelectEnable" width="30px;" [ngClass]="{'np-sticky-header-filter' : isStickyHeader}" class="txt-center"> </th>
                    <th *ngFor="let column of _columns; let j = index" [ngClass]="{'np-sticky-header-filter' : isStickyHeader,'hidden': column.visible == false}">
                        <div *ngIf="column.filterEnabled">
                            <div class="filter-type-group">
                                <div class="filter-type">
                                    <select [(ngModel)]="column.filterType" (change)="_onFilter(column, false)">
                                        <option
                                            *ngFor="let filterType of _filtersList | filterTypesPipe: column.dataType"
                                            [ngValue]="filterType.name" [innerText]="filterType.text"></option>
                                    </select>
                                </div>
                                <div class="filter-remove">
                                    <a title="Remove filter" (click)="_removeFilterStringFromColumn(column)"><i
                                            class="demo-icon icon-cancel"></i></a>
                                </div>
                            </div>
                            <div class="filter-text">
                                <input type="text" [(ngModel)]="column.filterString" (input)="_onFilter(column, false)" placeholder="search..." *ngIf="column.dataType == _dataTypes.string">
                                <input type="number" [(ngModel)]="column.filterString" (input)="_onFilter(column, false)" placeholder="search..." *ngIf="column.dataType == _dataTypes.number">
                                <input type="date" [(ngModel)]="column.filterString" (input)="_onFilter(column, false)" placeholder="search..." *ngIf="column.dataType == _dataTypes.date">
                                <select [(ngModel)]="column.filterString" *ngIf="column.dataType == _dataTypes.boolean" (change)="_onFilter(column, false)">
                                    <option value="true">True</option>
                                    <option value="false">False</option>
                                </select>
                            </div>
                        </div>
                    </th>
                </tr>
            </thead>
            <tbody>
                <ng-container *ngFor="let data of _currentViewData; let  i = index">
                    <tr id="row_{{i}}" (click)="_rowClick($event,data)">
                        <td *ngIf="_enableMasterChild" class="txt-center">
                            <a *ngIf="!_isOpen(data[_key])" (click)="_openMasterChild(data[_key])" class="child-toggle-link"><i class="demo-icon icon-plus"></i></a>
                            <a *ngIf="_isOpen(data[_key])" (click)="_openMasterChild(data[_key])" class="child-toggle-link"><i class="demo-icon icon-minus"></i></a>
                        </td>
                        <td *ngIf="singleSelectEnable || multiSelectEnable" width="30px;" class="txt-center">
                            <input type="checkbox" [checked]="_isSelected(data[_key])" (change)="_onSelectRow(data[_key],$event)">
                        </td>
                        <td *ngFor="let column of _columns; let j = index" (click)="_onCellClick($event, column, data)" [ngClass]="{'hidden': column.visible == false, 'txt-right-align' : column.rightAlignText}" [class]="column.styleClass">
                            <ng-container *ngIf="!column.cellTemplate; else customTemplate">
                                {{data[column.dataField]}}
                            </ng-container>
                            <ng-template #customTemplate [ngTemplateOutlet]="column.cellTemplate" [ngTemplateOutletContext]="{ row: data }">
                            </ng-template>
                        </td>
                    </tr>
                    <tr id="row_{{i}}_child" *ngIf="_enableMasterChild && _isOpen(data[_key])">
                        <td [attr.colspan]="_visibleColumnCount + (singleSelectEnable || multiSelectEnable ? 1 : 0) + 1">
                            <ng-container *ngTemplateOutlet="masterChildTemplate;context:{ row: data }">
                            </ng-container>
                        </td>
                    </tr>
                </ng-container>
            </tbody>
        </table>
        <div *ngIf="_currentViewData && _currentViewData.length == 0 && !_showLoader" class="no-data-message">
            No data avaialable.
        </div>
    </div>
    <div [ngClass]="{'locked': _showLoader}">
        <div class="np-pagination">
            <div class="div-page-size">
                <select [(ngModel)]="_pager.pageSize" (change)="_onPageSizeChange()">
                    <option value="10">10</option>
                    <option value="20">20</option>
                    <option value="50">50</option>
                </select> of {{_total}}
                <button type="button" title="Refresh" class="np-button" (click)="_onRefresh()"><i
                        class="demo-icon icon-refresh"></i></button>
            </div>
            <ul *ngIf="_pager.pages && _pager.pages.length">
                <li>
                    <button type="button" class="np-button" title="First page" [disabled]="_pager.currentPage === 1" (click)="_getCurrentViewData(1)"><i class="demo-icon icon-left font-no-margin"></i><i
                            class="demo-icon icon-left font-no-margin"></i></button>
                </li>
                <li>
                    <button type="button" class="np-button" title="Prev page" [disabled]="_pager.currentPage === 1" (click)="_getCurrentViewData(_pager.currentPage - 1)"><i
                            class="demo-icon icon-left"></i></button>
                </li>
                <li *ngFor="let page of _pager.pages">
                    <button type="button" class="np-button" (click)="_getCurrentViewData(page)" [ngClass]="{active:_pager.currentPage === page}">{{page}}</button>
                </li>
                <li>
                    <button type="button" title="Next page" class="np-button" [disabled]="_pager.currentPage === _pager.totalPages" (click)="_getCurrentViewData(_pager.currentPage + 1)"><i
                            class="demo-icon icon-right"></i></button>
                </li>
                <li>
                    <button type="button" title="Last page" class="np-button" [disabled]="_pager.currentPage === _pager.totalPages" (click)="_getCurrentViewData(_pager.totalPages)"><i
                            class="demo-icon icon-right font-no-margin"></i>
                        <i class="demo-icon icon-right font-no-margin"></i>
                    </button>
                </li>
            </ul>
        </div>
    </div>
</div>